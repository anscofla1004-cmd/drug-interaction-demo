<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ì•½ë¬¼ ë³‘ìš© ì•ˆì „ ì²´í¬</title>
  <style>
    body {
      font-family: 'Noto Sans KR', sans-serif;
      background-color: #F5F7FA;
      color: #333;
      margin: 0;
      padding: 20px;
    }

    .container {
      max-width: 600px;
      margin: auto;
      background: #fff;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.05);
    }

    h2 {
      text-align: center;
      color: #4A90E2;
      font-size: 24px;
      margin-bottom: 20px;
    }

    input {
      padding: 12px;
      margin: 8px 0;
      width: calc(100% - 24px);
      border: 1px solid #ddd;
      border-radius: 10px;
      font-size: 16px;
      background: #FAFBFD;
      transition: border-color 0.2s;
    }
    input:focus {
      border-color: #4A90E2;
      outline: none;
    }

    button {
      padding: 12px 18px;
      background-color: #4A90E2;
      border: none;
      color: white;
      font-size: 16px;
      border-radius: 12px;
      cursor: pointer;
      width: 100%;
      margin-top: 12px;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #357ABD;
    }

    .result {
      margin-top: 25px;
      padding: 18px;
      border-radius: 12px;
      background-color: #F0F4F8;
      font-size: 15px;
      line-height: 1.6;
      white-space: pre-wrap;
    }

    .warn {
      color: #FF6B6B;
      font-weight: bold;
    }

    .ok {
      color: #4CAF50;
      font-weight: bold;
    }

    .danger {
      color: #FF6B6B;
      font-weight: bold;
    }

    .loading {
      color: #4A90E2;
    }
  </style>
</head>
<body>

 <div class="container">
    <h2>ğŸ’Š ì•½ë¬¼ ë³‘ìš© ì•ˆì „ ì²´í¬</h2>
    <input type="text" id="drug1" placeholder="ì²« ë²ˆì§¸ ì•½ ì´ë¦„ ì…ë ¥" />
    <input type="text" id="drug2" placeholder="ë‘ ë²ˆì§¸ ì•½ ì´ë¦„ ì…ë ¥" />
    <button id="checkBtn">ğŸ” ê¶í•© í™•ì¸í•˜ê¸°</button>
    <div id="result" class="result"></div>
  </div>
  
<div class="footer">
  âš ï¸ ì°¸ê³ ìš© ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ì „ë¬¸ê°€ ìƒë‹´ì„ ê¼­ ë°›ìœ¼ì„¸ìš”.<br/>
  ë°ì´í„° ì¶œì²˜: ë¯¸êµ­ NLM RxNav API 
  (<a href="https://rxnav.nlm.nih.gov/" target="_blank">https://rxnav.nlm.nih.gov/</a>)
</div>

<style>
  .footer {
    text-align: center;
    margin-top: 30px;
    font-size: 13px;
    color: #777;
    line-height: 1.6;
    font-style: italic;
  }

  .footer a {
    color: #4A90E2;
    text-decoration: none;
  }
  .footer a:hover {
    text-decoration: underline;
  }
</style>


<script>
const korToEngDrugMap = {
  "íƒ€ì´ë ˆë†€": "acetaminophen",
  "ì•„ì„¸íŠ¸ì•„ë¯¸ë…¸íœ": "acetaminophen",
  "ì´ë¶€í”„ë¡œíœ": "ibuprofen",
  "ì™€íŒŒë¦°": "warfarin",
  "ì•„ìŠ¤í”¼ë¦°": "aspirin",
  "í´ë¡œí”¼ë„ê·¸ë ": "clopidogrel",
  "ë””ê³¡ì‹ ": "digoxin",
  "ë¦¬íŠ¬": "lithium",
  "í”„ë ˆë“œë‹ˆì†": "prednisone",
  "ë©”í† íŠ¸ë ‰ì„¸ì´íŠ¸": "methotrexate",
  "ì„¸ë¡œí† ë‹Œ": "serotonin",
  "ì˜¤ë©”í”„ë¼ì¡¸": "omeprazole",
  "ë¡œë¼íƒ€ë”˜": "loratadine",
  "í˜ë‹ˆì‹¤ë¦°": "penicillin",
  "ì•”ë¡œë””í•€": "amlodipine",
  "ë² ë¼íŒŒë°€": "verapamil",
  "ì—ë¦¬íŠ¸ë¡œë§ˆì´ì‹ ": "erythromycin",
  "í…ŒíŠ¸ë¼ì‚¬ì´í´ë¦°": "tetracycline",
  "ë ˆë³´í”Œë¡ì‚¬ì‹ ": "levofloxacin",
  "ì‹œí”„ë¡œí”Œë¡ì‚¬ì‹ ": "ciprofloxacin",
  "ì½”ë°ì¸": "codeine",
  "ëª¨ë¥´í•€": "morphine",
  "ë””ì•„ì œíŒœ": "diazepam",
  "ì•Œí”„ë¼ì¡¸ëŒ": "alprazolam",
  "ì¡¸í”¼ë€": "zolpidem",
  "ë¡œë¼ì œíŒœ": "lorazepam",
  "íˆë“œë¡œì½”ëˆ": "hydrocodone",
  "ë‚˜í”„ë¡ì„¼": "naproxen",
  "ë©œë¡ì‹œìº„": "meloxicam",
  "ì¼€í† í”„ë¡œíœ": "ketoprofen",
  "í˜ë‹ˆí† ì¸": "phenytoin",
  "ë°œí”„ë¡œì‚°": "valproic acid",
  "ì¹´ë°”ë§ˆì œí•€": "carbamazepine",
  "í˜ë…¸ë°”ë¥´ë¹„íƒˆ": "phenobarbital",
  "ì•„ë¯¸íŠ¸ë¦¬í”„í‹¸ë¦°": "amitriptyline",
  "ì´ë¯¸í”„ë¼ë¯¼": "imipramine",
  "í”Œë£¨ì˜¥ì„¸í‹´": "fluoxetine",
  "íŒŒë¡ì„¸í‹´": "paroxetine",
  "ì„¤íŠ¸ë„ë¦°": "sertraline",
  "ì—ìŠ¤ì‹œíƒˆë¡œí”„ëŒ": "escitalopram",
  "ë²¤ë¼íŒì‹ ": "venlafaxine",
  "ë‘ë¡ì„¸í‹´": "duloxetine",
  "í• ë¡œí˜ë¦¬ëŒ": "haloperidol",
  "ë¦¬íŒœí”¼ì‹ ": "rifampin",
  "ì´ì†Œë‹ˆì•„ì§€ë“œ": "isoniazid",
  "ì—í† í¬ì‚¬ì´ë“œ": "etoposide",
  "ë„ì„¸íƒì…€": "docetaxel",
  "íŒŒí´ë¦¬íƒì…€": "paclitaxel",
  "ì•”í˜¸í™”í•€": "amoxicillin",
  "ì„¤íŒŒë©”í†¡ì‚¬ì¡¸": "sulfamethoxazole",
  "íŠ¸ë¦¬ë©”í† í”„ë¦¼": "trimethoprim",
  "ì‹œìŠ¤í”Œë¼í‹´": "cisplatin",
  "ë‹¤ì´ì•„ì œíŒœ": "diazepam",
  "ê¸€ë¦¬ë©”í”¼ë¦¬ë“œ": "glimepiride",
  "ë©”íŠ¸í¬ë¥´ë¯¼": "metformin",
  "ì¸ìŠë¦°": "insulin",
  "ë¼ë‹ˆí‹°ë”˜": "ranitidine",
  "íŒŒë§ˆí†¨ë¦°": "famotidine",
  "ë„ë¶€íƒ€ë¯¼": "dobutamine",
  "ë„íŒŒë¯¼": "dopamine",
  "ë„¤í˜ë¦¬ë”˜": "nefopam",
  "í”„ë¼ë¯¸í™ì†”": "pramipexole",
  "ë¡œí”¼ë‚˜ë¹„ë¥´": "lopinavir",
  "ë¦¬í† ë‚˜ë¹„ë¥´": "ritonavir",
  "ì ¬í”¼ë¸Œë¡œì§ˆ": "gemfibrozil",
  "ì½œë ˆìŠ¤í‹°ë¼ë¯¼": "cholestyramine",
  "ì•„í† ë¥´ë°”ìŠ¤íƒ€í‹´": "atorvastatin",
  "ì‹¬ë°”ìŠ¤íƒ€í‹´": "simvastatin",
  "ë¡œìˆ˜ë°”ìŠ¤íƒ€í‹´": "rosuvastatin",
  "í”¼ë¸Œë ˆì´íŠ¸": "fibrate",
  "í´ë¡œë¥´í”„ë¡œë§ˆì§„": "chlorpromazine",
  "í´ë¡œìí•€": "clozapine",
  "ì˜¬ë€ìí•€": "olanzapine",
  "í€˜í‹°ì•„í•€": "quetiapine",
  "ë¦¬ìŠ¤í˜ë¦¬ëˆ": "risperidone",
  "ì¡¸í”¼ë€": "zolpidem",
  "ì œí”¼ë¥´ë¼ìŠ¤í‹´": "cefpirazole",
  "ëª¨í‹°ë¦¬ì›€": "domperidone",
  "í”„ë¡œí”„ë¼ë†€ë¡¤": "propranolol",
  "ì•„í…Œë†€ë¡¤": "atenolol",
  "ì¹´ë¥´ë² ë”œë¡¤": "carvedilol",
  "ë©”í† í”„ë¡¤ë¡¤": "metoprolol",
  "ë¼ë² íƒ€ë¡¤": "labetalol",
  "ì•Œí…Œí”Œë¼ì œ": "alteplase",
  "ì—í”¼ë„¤í”„ë¦°": "epinephrine",
  "í”¼ë¡œì¹´ë¥´í”¼": "pilocarpine",
  "ë²¤ì¡°ë‹¤ì´ì•„ì œí•€": "benzodiazepine",
  "ë””íœíˆë“œë¼ë¯¼": "diphenhydramine",
  "í˜ë‹ˆë¼ë¯¼": "pheniramine",
  "í¬ë¡œë¥´í˜ë‹ˆë¼ë¯¼": "chlorpheniramine",
  "í”Œë£¨í˜ë‚˜ì§„": "fluphenazine",
  "íˆë“œë¡œí´ë¡œë¡œí‹°ì•„ì§€ë“œ": "hydrochlorothiazide",
  "í‘¸ë¡œì„¸ë§ˆì´ë“œ": "furosemide",
  "ìŠ¤í”¼ë¡œë†€ë½í†¤": "spironolactone",
  "ì—ë‚ ë¼í”„ë¦´": "enalapril",
  "ë¦¬ìŠ¤ë…¸í”„ë¦´": "lisinopril",
  "ìº„í”„ë¡œí…Œë¦­ìŠ¤": "camptothecin"
  // ... í•„ìš”ì‹œ ë” ì¶”ê°€ ê°€ëŠ¥
};


// í•˜ë“œì½”ë”© ìƒí˜¸ì‘ìš© ë°ì´í„°
const hardcodedInteractions = {
  "warfarin+aspirin": {
    message: "âš ï¸ ì™€íŒŒë¦°ê³¼ ì•„ìŠ¤í”¼ë¦°ì€ ì¶œí˜ˆ ìœ„í—˜ì´ ì¦ê°€í•˜ë‹ˆ ì£¼ì˜í•˜ì„¸ìš”!",
    reason: "í˜ˆì•¡ì‘ê³  ì–µì œë¡œ ì¸í•´ ê³¼ë„í•œ ì¶œí˜ˆ ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤."
  },
  "aspirin+warfarin": {
    message: "âš ï¸ ì™€íŒŒë¦°ê³¼ ì•„ìŠ¤í”¼ë¦°ì€ ì¶œí˜ˆ ìœ„í—˜ì´ ì¦ê°€í•˜ë‹ˆ ì£¼ì˜í•˜ì„¸ìš”!",
    reason: "í˜ˆì•¡ì‘ê³  ì–µì œë¡œ ì¸í•´ ê³¼ë„í•œ ì¶œí˜ˆ ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤."
  },
  "acetaminophen+ibuprofen": {
    message: "âš ï¸ íƒ€ì´ë ˆë†€ê³¼ ì´ë¶€í”„ë¡œíœ ë³‘ìš© ì‹œ ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤.",
    reason: "ë‘ ì•½ë¬¼ ëª¨ë‘ ê°„ê³¼ ì‹ ì¥ì— ë¶€ë‹´ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
  },
  "ibuprofen+acetaminophen": {
    message: "âš ï¸ íƒ€ì´ë ˆë†€ê³¼ ì´ë¶€í”„ë¡œíœ ë³‘ìš© ì‹œ ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤.",
    reason: "ë‘ ì•½ë¬¼ ëª¨ë‘ ê°„ê³¼ ì‹ ì¥ì— ë¶€ë‹´ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
  },
  "warfarin+clopidogrel": {
    message: "âš ï¸ ì™€íŒŒë¦°ê³¼ í´ë¡œí”¼ë„ê·¸ë  ë³‘ìš© ì‹œ ì¶œí˜ˆ ìœ„í—˜ì´ í¬ê²Œ ì¦ê°€í•©ë‹ˆë‹¤.",
    reason: "í•­ì‘ê³ ì œì™€ í•­í˜ˆì†ŒíŒì œì˜ ë³‘ìš©ìœ¼ë¡œ ì¶œí˜ˆ ê°€ëŠ¥ì„±ì´ ë†’ì•„ì§‘ë‹ˆë‹¤."
  },
  "clopidogrel+warfarin": {
    message: "âš ï¸ ì™€íŒŒë¦°ê³¼ í´ë¡œí”¼ë„ê·¸ë  ë³‘ìš© ì‹œ ì¶œí˜ˆ ìœ„í—˜ì´ í¬ê²Œ ì¦ê°€í•©ë‹ˆë‹¤.",
    reason: "í•­ì‘ê³ ì œì™€ í•­í˜ˆì†ŒíŒì œì˜ ë³‘ìš©ìœ¼ë¡œ ì¶œí˜ˆ ê°€ëŠ¥ì„±ì´ ë†’ì•„ì§‘ë‹ˆë‹¤."
  },
  "lithium+diuretics": {
    message: "âš ï¸ ë¦¬íŠ¬ê³¼ ì´ë‡¨ì œ ë³‘ìš© ì‹œ ë¦¬íŠ¬ ë†ë„ ìƒìŠ¹ ìœ„í—˜ì´ ìˆìŠµë‹ˆë‹¤.",
    reason: "ì´ë‡¨ì œê°€ ë¦¬íŠ¬ ë°°ì„¤ì„ ê°ì†Œì‹œì¼œ ë…ì„± ìœ„í—˜ì„ ë†’ì…ë‹ˆë‹¤."
  },
  "lithium+ace inhibitors": {
    message: "âš ï¸ ë¦¬íŠ¬ê³¼ ACE ì–µì œì œ ë³‘ìš© ì‹œ ë¦¬íŠ¬ ë…ì„± ìœ„í—˜ì´ ì¦ê°€í•©ë‹ˆë‹¤.",
    reason: "ì‹ ì¥ ê¸°ëŠ¥ ì €í•˜ë¡œ ë¦¬íŠ¬ ë†ë„ê°€ ìƒìŠ¹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
  },
  "digoxin+verapamil": {
    message: "âš ï¸ ë””ê³¡ì‹ ê³¼ ë² ë¼íŒŒë°€ ë³‘ìš© ì‹œ ë””ê³¡ì‹  ë…ì„±ì´ ì¦ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    reason: "ë² ë¼íŒŒë°€ì´ ë””ê³¡ì‹  ëŒ€ì‚¬ë¥¼ ì €í•´í•©ë‹ˆë‹¤."
  },
  "methotrexate+NSAIDs": {
    message: "âš ï¸ ë©”í† íŠ¸ë ‰ì„¸ì´íŠ¸ì™€ NSAIDs ë³‘ìš© ì‹œ ì‹ ì¥ë…ì„± ìœ„í—˜ì´ ìˆìŠµë‹ˆë‹¤.",
    reason: "NSAIDsê°€ ë©”í† íŠ¸ë ‰ì„¸ì´íŠ¸ ë°°ì„¤ì„ ë°©í•´í•©ë‹ˆë‹¤."
  },
  "prednisone+fluoroquinolones": {
    message: "âš ï¸ í”„ë ˆë“œë‹ˆì†ê³¼ í”Œë£¨ì˜¤ë¡œí€´ë†€ë¡  í•­ìƒì œ ë³‘ìš© ì‹œ í˜ì¤„ íŒŒì—´ ìœ„í—˜ ì¦ê°€",
    reason: "ìŠ¤í…Œë¡œì´ë“œì™€ ì¼ë¶€ í•­ìƒì œ ë³‘ìš© ì‹œ í˜ì¤„ ì†ìƒ ìœ„í—˜ì´ ì»¤ì§‘ë‹ˆë‹¤."
  },
  "serotonin+ssri": {
    message: "âš ï¸ ì„¸ë¡œí† ë‹Œê³¼ SSRI ë³‘ìš© ì‹œ ì„¸ë¡œí† ë‹Œ ì¦í›„êµ° ìœ„í—˜",
    reason: "ì¤‘ì¶”ì‹ ê²½ê³„ì—ì„œ ì„¸ë¡œí† ë‹Œ ê³¼ì‰ìœ¼ë¡œ ì¦í›„êµ° ë°œìƒ ê°€ëŠ¥."
  },
  "acetaminophen+alcohol": {
    message: "âš ï¸ íƒ€ì´ë ˆë†€ê³¼ ì•Œì½”ì˜¬ ë³‘ìš© ì‹œ ê°„ ì†ìƒ ìœ„í—˜ ì¦ê°€",
    reason: "ê°„ì— ë¶€ë‹´ì„ ì£¼ì–´ ê°„ë…ì„± ìœ„í—˜ì´ ì¦ê°€í•©ë‹ˆë‹¤."
  },
  "ibuprofen+warfarin": {
    message: "âš ï¸ ì´ë¶€í”„ë¡œíœê³¼ ì™€íŒŒë¦° ë³‘ìš© ì‹œ ì¶œí˜ˆ ìœ„í—˜ ì¦ê°€",
    reason: "NSAIDsê°€ í˜ˆì†ŒíŒ ê¸°ëŠ¥ì„ ì–µì œí•˜ì—¬ ì¶œí˜ˆ ìœ„í—˜ì´ ì»¤ì§‘ë‹ˆë‹¤."
  },
  "aspirin+ibuprofen": {
    message: "âš ï¸ ì•„ìŠ¤í”¼ë¦°ê³¼ ì´ë¶€í”„ë¡œíœ ë³‘ìš© ì‹œ ì•„ìŠ¤í”¼ë¦° íš¨ê³¼ ì €í•˜ ìš°ë ¤",
    reason: "ì´ë¶€í”„ë¡œíœì´ ì•„ìŠ¤í”¼ë¦°ì˜ í˜ˆì†ŒíŒ ì–µì œ íš¨ê³¼ë¥¼ ë°©í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
  },
  "clopidogrel+omeprazole": {
    message: "âš ï¸ í´ë¡œí”¼ë„ê·¸ë ê³¼ ì˜¤ë©”í”„ë¼ì¡¸ ë³‘ìš© ì‹œ ì•½íš¨ ê°ì†Œ ê°€ëŠ¥ì„±",
    reason: "ì˜¤ë©”í”„ë¼ì¡¸ì´ í´ë¡œí”¼ë„ê·¸ë  í™œì„±í™”ë¥¼ ë°©í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
  },
  "digoxin+loop diuretics": {
    message: "âš ï¸ ë””ê³¡ì‹ ê³¼ ë£¨í”„ ì´ë‡¨ì œ ë³‘ìš© ì‹œ ë¶€ì •ë§¥ ìœ„í—˜ ì¦ê°€",
    reason: "ì´ë‡¨ì œë¡œ ì¸í•œ ì „í•´ì§ˆ ë¶ˆê· í˜•ì´ ë””ê³¡ì‹  ë…ì„±ì„ ì•…í™”ì‹œí‚µë‹ˆë‹¤."
  },
  "lithium+NSAIDs": {
    message: "âš ï¸ ë¦¬íŠ¬ê³¼ NSAIDs ë³‘ìš© ì‹œ ë¦¬íŠ¬ ë†ë„ ìƒìŠ¹ ìœ„í—˜",
    reason: "NSAIDsê°€ ë¦¬íŠ¬ ë°°ì„¤ì„ ë°©í•´í•˜ì—¬ ë…ì„±ì´ ì¦ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
  },
  "methotrexate+penicillin": {
    message: "âš ï¸ ë©”í† íŠ¸ë ‰ì„¸ì´íŠ¸ì™€ í˜ë‹ˆì‹¤ë¦° ë³‘ìš© ì‹œ ì‹ ì¥ ë…ì„± ìœ„í—˜ ì¦ê°€",
    reason: "í˜ë‹ˆì‹¤ë¦°ì´ ë©”í† íŠ¸ë ‰ì„¸ì´íŠ¸ ë°°ì„¤ì„ ì €í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
  },
  "prednisone+live vaccines": {
    message: "âš ï¸ í”„ë ˆë“œë‹ˆì† ë³µìš© ì‹œ ìƒë°±ì‹  ì ‘ì¢… ìœ„í—˜",
    reason: "ë©´ì—­ì–µì œì œë¡œ ë°±ì‹  ì ‘ì¢… í›„ ê°ì—¼ ìœ„í—˜ì´ ì»¤ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
  },
  "amiodarone+warfarin": {
    message: "âš ï¸ ì•„ë¯¸ì˜¤ë‹¤ë¡ ê³¼ ì™€íŒŒë¦° ë³‘ìš© ì‹œ ì¶œí˜ˆ ìœ„í—˜ ì¦ê°€",
    reason: "ì•„ë¯¸ì˜¤ë‹¤ë¡ ì´ ì™€íŒŒë¦° ëŒ€ì‚¬ë¥¼ ì–µì œí•©ë‹ˆë‹¤."
  },
  "simvastatin+amiodarone": {
    message: "âš ï¸ ì‹¬ë°”ìŠ¤íƒ€í‹´ê³¼ ì•„ë¯¸ì˜¤ë‹¤ë¡  ë³‘ìš© ì‹œ ê·¼ìœ¡ ë…ì„± ìœ„í—˜ ì¦ê°€",
    reason: "ë‘ ì•½ë¬¼ì´ ê·¼ìœ¡ë…ì„±(íš¡ë¬¸ê·¼ìœµí•´ì¦) ìœ„í—˜ì„ ì¦ê°€ì‹œí‚µë‹ˆë‹¤."
  },
  "ciprofloxacin+theophylline": {
    message: "âš ï¸ ì‹œí”„ë¡œí”Œë¡ì‚¬ì‹ ê³¼ í…Œì˜¤í•„ë¦° ë³‘ìš© ì‹œ í…Œì˜¤í•„ë¦° ë…ì„± ì¦ê°€",
    reason: "ì‹œí”„ë¡œí”Œë¡ì‚¬ì‹ ì´ í…Œì˜¤í•„ë¦° ëŒ€ì‚¬ë¥¼ ì–µì œí•©ë‹ˆë‹¤."
  },
  "phenytoin+warfarin": {
    message: "âš ï¸ í˜ë‹ˆí† ì¸ê³¼ ì™€íŒŒë¦° ë³‘ìš© ì‹œ ì™€íŒŒë¦° íš¨ê³¼ ê°ì†Œ ê°€ëŠ¥ì„±",
    reason: "í˜ë‹ˆí† ì¸ì´ ì™€íŒŒë¦° ëŒ€ì‚¬ë¥¼ ì¦ê°€ì‹œí‚µë‹ˆë‹¤."
  },
  "valproic acid+lamotrigine": {
    message: "âš ï¸ ë°œí”„ë¡œì‚°ê³¼ ë¼ëª¨íŠ¸ë¦¬ì§„ ë³‘ìš© ì‹œ ë¼ëª¨íŠ¸ë¦¬ì§„ ë†ë„ ì¦ê°€",
    reason: "ë°œí”„ë¡œì‚°ì´ ë¼ëª¨íŠ¸ë¦¬ì§„ ëŒ€ì‚¬ë¥¼ ì–µì œí•©ë‹ˆë‹¤."
  },
  "erythromycin+statins": {
    message: "âš ï¸ ì—ë¦¬íŠ¸ë¡œë§ˆì´ì‹ ê³¼ ìŠ¤íƒ€í‹´ ë³‘ìš© ì‹œ ê·¼ìœ¡ ë…ì„± ìœ„í—˜ ì¦ê°€",
    reason: "ì—ë¦¬íŠ¸ë¡œë§ˆì´ì‹ ì´ ìŠ¤íƒ€í‹´ ëŒ€ì‚¬ë¥¼ ë°©í•´í•©ë‹ˆë‹¤."
  },
  "fluoxetine+tamoxifen": {
    message: "âš ï¸ í”Œë£¨ì˜¥ì„¸í‹´ê³¼ íƒ€ëª©ì‹œíœ ë³‘ìš© ì‹œ íƒ€ëª©ì‹œíœ íš¨ê³¼ ê°ì†Œ ê°€ëŠ¥",
    reason: "í”Œë£¨ì˜¥ì„¸í‹´ì´ íƒ€ëª©ì‹œíœ í™œì„±í™”ë¥¼ ì–µì œí•©ë‹ˆë‹¤."
  },
  "rifampin+oral contraceptives": {
    message: "âš ï¸ ë¦¬íŒœí•€ê³¼ ê²½êµ¬í”¼ì„ì•½ ë³‘ìš© ì‹œ í”¼ì„ íš¨ê³¼ ê°ì†Œ",
    reason: "ë¦¬íŒœí•€ì´ ê²½êµ¬í”¼ì„ì•½ ëŒ€ì‚¬ë¥¼ ì¦ê°€ì‹œí‚µë‹ˆë‹¤."
  },
  "metformin+contrast media": {
    message: "âš ï¸ ë©”íŠ¸í¬ë¥´ë¯¼ê³¼ ì¡°ì˜ì œ ë³‘ìš© ì‹œ ì –ì‚°ì‚°ì¦ ìœ„í—˜ ì¦ê°€",
    reason: "ì¡°ì˜ì œì— ì˜í•œ ì‹ ì¥ ì†ìƒì´ ë©”íŠ¸í¬ë¥´ë¯¼ ëŒ€ì‚¬ì— ì˜í–¥ ì¤ë‹ˆë‹¤."
  },
  "lisinopril+potassium supplements": {
    message: "âš ï¸ ë¦¬ì‹œë…¸í”„ë¦´ê³¼ ì¹¼ë¥¨ ë³´ì¶©ì œ ë³‘ìš© ì‹œ ê³ ì¹¼ë¥¨í˜ˆì¦ ìœ„í—˜",
    reason: "ë‘˜ ë‹¤ í˜ˆì¤‘ ì¹¼ë¥¨ ìƒìŠ¹ì„ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
  },
  "digoxin+spironolactone": {
    message: "âš ï¸ ë””ê³¡ì‹ ê³¼ ìŠ¤í”¼ë¡œë†€ë½í†¤ ë³‘ìš© ì‹œ ë¶€ì •ë§¥ ìœ„í—˜ ì¦ê°€",
    reason: "ìŠ¤í”¼ë¡œë†€ë½í†¤ì´ ì¹¼ë¥¨ ë†ë„ë¥¼ ë³€í™”ì‹œì¼œ ë””ê³¡ì‹  ì‘ìš©ì— ì˜í–¥."
  },
  "phenytoin+oral contraceptives": {
    message: "âš ï¸ í˜ë‹ˆí† ì¸ê³¼ ê²½êµ¬í”¼ì„ì•½ ë³‘ìš© ì‹œ í”¼ì„ íš¨ê³¼ ê°ì†Œ ê°€ëŠ¥ì„±",
    reason: "í˜ë‹ˆí† ì¸ì´ í”¼ì„ì•½ ëŒ€ì‚¬ë¥¼ ì´‰ì§„í•©ë‹ˆë‹¤."
  },
  "fluoxetine+triptans": {
    message: "âš ï¸ í”Œë£¨ì˜¥ì„¸í‹´ê³¼ íŠ¸ë¦½íƒ„ ë³‘ìš© ì‹œ ì„¸ë¡œí† ë‹Œ ì¦í›„êµ° ìœ„í—˜ ì¦ê°€",
    reason: "ì„¸ë¡œí† ë‹Œ ì¤‘ì¶” ê³¼ë‹¤ í™œì„±í™” ê°€ëŠ¥ì„±."
  },
  "valproic acid+lamotrigine": {
    message: "âš ï¸ ë°œí”„ë¡œì‚°ê³¼ ë¼ëª¨íŠ¸ë¦¬ì§„ ë³‘ìš© ì‹œ ë¼ëª¨íŠ¸ë¦¬ì§„ ë†ë„ ì¦ê°€",
    reason: "ë°œí”„ë¡œì‚°ì´ ë¼ëª¨íŠ¸ë¦¬ì§„ ëŒ€ì‚¬ë¥¼ ì–µì œí•©ë‹ˆë‹¤."
  }
  // í•„ìš”í•œ ë§Œí¼ ê³„ì† ì¶”ê°€ ê°€ëŠ¥
};


async function getRxcui(drugName) {
  const url = `https://rxnav.nlm.nih.gov/REST/rxcui.json?name=${encodeURIComponent(drugName)}&search=1`;
  try {
    const res = await fetch(url);
    if (!res.ok) return null;
    const data = await res.json();
    if (data.idGroup && data.idGroup.rxnormId && data.idGroup.rxnormId.length > 0) {
      return data.idGroup.rxnormId[0];
    }
    return null;
  } catch (e) {
    return null;
  }
}

async function getInteraction(rxcui1, rxcui2) {
  try {
    const res = await fetch(`https://rxnav.nlm.nih.gov/REST/interaction/list.json?rxcuis=${rxcui1}+${rxcui2}`);
    if (!res.ok) return null;
    const data = await res.json();
    if (!data.fullInteractionTypeGroup) return null;

    const groups = data.fullInteractionTypeGroup;
    for (const group of groups) {
      for (const interactionType of group.fullInteractionType) {
        const interactions = interactionType.interactionPair;
        for (const pair of interactions) {
          const rxcuiSet = [pair.interactionConcept[0].minConceptItem.rxcui, pair.interactionConcept[1].minConceptItem.rxcui];
          if (rxcuiSet.includes(rxcui1) && rxcuiSet.includes(rxcui2)) {
            // descriptionì€ ë¬¸ìì—´ì´ë¼ ë°”ë¡œ ë¦¬í„´
            return pair.description || "ìƒí˜¸ì‘ìš©ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤.";
          }
        }
      }
    }
    return null;
  } catch {
    return null;
  }
}

function renderResult(message, source = "") {
  const resultDiv = document.getElementById("result");
  if (!message) {
    resultDiv.innerHTML = `<p class="ok">í˜„ì¬ ì•Œë ¤ì§„ íŠ¹ë³„í•œ ìƒí˜¸ì‘ìš©ì´ ì—†ìŠµë‹ˆë‹¤.</p>`;
  } else {
    if (typeof message === "object") {
      // ê°ì²´ë©´ ì˜ˆì˜ê²Œ JSON ë¬¸ìì—´ë¡œ ë³€í™˜í•´ì„œ ì¶œë ¥
      message = JSON.stringify(message, null, 2);
    }
    const sourceText = source ? `<br/><small style="color:#666;">[ì¶œì²˜: ${source}]</small>` : "";
    resultDiv.innerHTML = `<pre class="warn">${message}</pre>${sourceText}`;
  }
}

function normalizeDrugName(name) {
  if (!name) return "";
  name = name.trim().toLowerCase();
  // í•œê¸€ì´ë©´ ì˜ì–´ ë³€í™˜
  for (const [kor, eng] of Object.entries(korToEngDrugMap)) {
    if (kor.toLowerCase() === name) {
      return eng;
    }
  }
  return name;
}

async function checkInteraction() {
  const drug1Input = document.getElementById("drug1");
  const drug2Input = document.getElementById("drug2");
  const resultDiv = document.getElementById("result");

  let drug1 = normalizeDrugName(drug1Input.value);
  let drug2 = normalizeDrugName(drug2Input.value);

  if (!drug1 || !drug2) {
    resultDiv.innerHTML = `<p class="danger">ë‘ ì•½ ì´ë¦„ì„ ëª¨ë‘ ì…ë ¥í•´ ì£¼ì„¸ìš”.</p>`;
    return;
  }

  if (drug1 === drug2) {
    resultDiv.innerHTML = `<p class="danger">ê°™ì€ ì•½ ì´ë¦„ ë‘ ê°œë¥¼ ì…ë ¥í•˜ì…¨ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì•½ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.</p>`;
    return;
  }

  resultDiv.innerHTML = `<p class="loading">ìƒí˜¸ì‘ìš© ì •ë³´ë¥¼ í™•ì¸í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤...</p>`;

  // í•˜ë“œì½”ë”© ìƒí˜¸ì‘ìš© ë¨¼ì € ì²´í¬
  const hardKey1 = `${drug1}+${drug2}`;
  const hardKey2 = `${drug2}+${drug1}`;
  if (hardcodedInteractions[hardKey1]) {
    const info = hardcodedInteractions[hardKey1];
    renderResult(`${info.message}\n\n[ì´ìœ ] ${info.reason}`, "í•˜ë“œì½”ë”© ë°ì´í„°");
    return;
  } else if (hardcodedInteractions[hardKey2]) {
    const info = hardcodedInteractions[hardKey2];
    renderResult(`${info.message}\n\n[ì´ìœ ] ${info.reason}`, "í•˜ë“œì½”ë”© ë°ì´í„°");
    return;
  }

  // RxNav APIë¥¼ ì´ìš©í•œ ì‹¤ì‹œê°„ ì¡°íšŒ
  const rxcui1 = await getRxcui(drug1);
  const rxcui2 = await getRxcui(drug2);

  if (!rxcui1 || !rxcui2) {
    renderResult("í•˜ë‚˜ ì´ìƒì˜ ì•½ì— ëŒ€í•´ RXCUIë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì•½ ì´ë¦„ì„ ë‹¤ì‹œ í™•ì¸í•´ ì£¼ì„¸ìš”.", "RxNav API");
    return;
  }

  const interactionDesc = await getInteraction(rxcui1, rxcui2);

  if (!interactionDesc) {
    renderResult(null);
  } else {
    renderResult(interactionDesc, "RxNav API");
  }
}

document.getElementById("checkBtn").addEventListener("click", checkInteraction);

document.getElementById("drug1").addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    e.preventDefault();
    document.getElementById("drug2").focus();
  }
});
document.getElementById("drug2").addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    e.preventDefault();
    checkInteraction();
  }
});
</script>

</body>
</html>
